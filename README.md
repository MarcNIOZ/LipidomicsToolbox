# LipidomicsToolbox
R scripts for converting &amp; processing HPLC-MS lipid data, and a test dataset. These scripts were developed in the [Van Mooy Lab](http://www.whoi.edu/page.do?pid=80356) at [Woods Hole Oceanographic Institution](http://www.whoi.edu/). Many of them were written specifically to prepare HPLC-ESI-MS data from an Exactive Orbitrap mass spectrometer for follow-on analysis with the [LOBSTAHS](http://github.com/vanmooylipidomics/LOBSTAHS) pipeline.

<h4>R scripts in this repository:</h4>

1. [prepOrbidata.R](https://github.com/vanmooylipidomics/LipidomicsToolbox/blob/master/prepOrbidata.R): The current version of LOBSTAHS presumes data pre-processing with [xcms](https://bioconductor.org/packages/release/bioc/html/xcms.html) and [CAMERA](https://bioconductor.org/packages/release/bioc/html/CAMERA.html); [prepOrbidata.R](https://github.com/vanmooylipidomics/LipidomicsToolbox/blob/master/prepOrbidata.R) can help with this. Includes interactive user prompts to facilitate "easy" analysis by users not deeply conversant in R. If the user chooses, applies [IPO](https://github.com/glibiseller/IPO) to optimize xcms peak picking and retention time correction parameters. Includes a function to write the results of each IPO optimization run to a .csv file so the results aren't lost.

2. [optim_centWaveParams_standalone.R](https://github.com/vanmooylipidomics/LipidomicsToolbox/blob/master/optim_centWaveParams_standalone.R): Uses [IPO](https://github.com/glibiseller/IPO) to optimize parameters for the [xcms](https://bioconductor.org/packages/release/bioc/html/xcms.html) peak picking function centWave. Works fine on its own, but has been folded into [prepOrbidata.R](https://github.com/vanmooylipidomics/LipidomicsToolbox/blob/master/prepOrbidata.R). Includes a function to write the results of each IPO optimization run to a .csv file so the results aren't lost.

3. [Exactive_full_scan_process_ms1+.r](https://github.com/vanmooylipidomics/LipidomicsToolbox/blob/master/Exactive_full_scan_process_ms1%2B.r): Scripted calling of the [msconvert](http://proteowizard.sourceforge.net/tools/msconvert.html) command line tool to convert Thermo Exactive Orbitrap .raw files obtained in polarity switching mode to .mzXML files that be read by [xcms](https://bioconductor.org/packages/release/bioc/html/xcms.html), [MAVEN](http://genomics-pubs.princeton.edu/mzroll/index.php), mzR, or your favorite program/package. [Exactive_full_scan_process_ms1+.r](https://github.com/vanmooylipidomics/LipidomicsToolbox/blob/master/Exactive_full_scan_process_ms1%2B.r) creates centroids and extracts positive and negative ion mode scans into separate .mzXML files. Gives user the option to convert all files in a particular directory, or only those files in a .txt document:
   * [mzxml_convert_list.txt](https://github.com/vanmooylipidomics/LipidomicsToolbox/blob/master/mzxml_convert_list.txt): For (optional) use with [Exactive_full_scan_process_ms1+.r](https://github.com/vanmooylipidomics/LipidomicsToolbox/blob/master/Exactive_full_scan_process_ms1%2B.r)

<h4>Data (.mzXML):</h4>

1. [Pt_H2O2_mzXML_ms1_pos](https://github.com/vanmooylipidomics/LipidomicsToolbox/tree/master/Pt_H2O2_mzXML_ms1_pos) and [Pt_H2O2_mzXML_ms1_neg](https://github.com/vanmooylipidomics/LipidomicsToolbox/tree/master/Pt_H2O2_mzXML_ms1_neg): Two directories containing .mzXML data files that have been converted, centroided, and extracted by ion mode using [Exactive_full_scan_process_ms1+.r](https://github.com/vanmooylipidomics/LipidomicsToolbox/blob/master/Exactive_full_scan_process_ms1%2B.r). These files contain Exactive Orbitrap lipid data from experiments in which hydrogen peroxide was added at different concentrations to cultures of the marine diatom Phaeodactylum tricornutum; the data were collected during the experiments described in [Graff van Creveld, et al., 2015, "Early perturbation in mitochondria redox homeostasis in response to environmental stress predicts cell fate in diatoms," ISME Journal 9:385-395](http://www.nature.com/ismej/journal/v9/n2/full/ismej2014136a.html). The original Thermo .raw files and some metadata can be accessed at http://www.whoi.edu/page.do?pid=133616&tid=282&cid=192529. The version of prepOrbidata.R in this repository is configured to work with this dataset.

<h4>A note on CAMERA and xcms versus other tools</h4>

While the scripts here use [xcms](https://bioconductor.org/packages/release/bioc/html/xcms.html) and [CAMERA](https://bioconductor.org/packages/release/bioc/html/CAMERA.html) to accomplish much of the necessary processing (peak picking, retention time correction, grouping, etc.), we've also used the fast and very good program [MAVEN](http://genomics-pubs.princeton.edu/mzroll/index.php) for many projects. In fact, the older version of our analysis pipeline relied on MAVEN for peak picking, chromatographic alignment, grouping, and assignment of compound identities from our databases; the scripts for the pipeline are still in the repository https://github.com/vanmooylipidomics/old_pipeline.
